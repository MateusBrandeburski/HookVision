{% extends 'template_generico.html' %}
{% block conteudo %}
<div class="p-4">
    <h1 class="display-4 fw-bold text-black p-3 text-white text-center" style="margin-bottom: 50px">Histórico de pagamentos</h1>
    <div>
        <div class="table-responsive">
        <p class="text-white" id="totalRegistros"></p>
            <table id="tableBody" class="table table-striped table-bordered border-black shadow-lg" style="background-color: rgb(255, 255, 255);">
                <thead class="thead-default">
                    <tr>
                        <th>Nome</th>
                        <th>Email</th>
                        <th>Status da transação</th>
                        <th>Status no sistema</th>
                        <th>Valor</th>
                        <th>Forma de pagamento</th>
                        <th>Parcelas</th>
                        <th>Data e hora</th>
                    </tr>
                </thead>
                <tbody>
                    {% for pagamento in pagamentos %}
                    <tr>
                        <td>{{ pagamento.nome }}</td>
                        <td>{{ pagamento.email }}</td>
                        <td>{{ pagamento.status }}</td>
                        <td>{{ pagamento.status_no_sistema }}</td>
                        <td>{{ pagamento.valor }}</td>
                        <td>{{ pagamento.forma_pagamento }}</td>
                        <td>{{ pagamento.parcelas }}</td>
                        <td>{{ pagamento.data }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div class="text-end">
            <button class="btn btn-outline-light" id="btnAnterior" disabled>Anterior</button>
            <button class="btn btn-outline-light" id="btnProximo">Próximo</button>
        </div>
    </div>
</div>

<p id="totalRegistros"></p>



<script>
  var paginaAtual = 1;
  var registrosPorPagina = 10;
  var registros; // Definindo a variável globalmente

  window.onload = function () {
    registros = document.getElementById("tableBody").getElementsByTagName("tr");
    document.getElementById("totalRegistros").innerText = "Total de Registros no DB: " + registros.length;
    exibirPagina(paginaAtual);
  };

  function exibirPagina(pagina) {
    for (var i = 0; i < registros.length; i++) {
      registros[i].style.display = "none";
    }

    var inicio = (pagina - 1) * registrosPorPagina;
    var fim = inicio + registrosPorPagina;

    for (var i = inicio; i < fim && i < registros.length; i++) {
      registros[i].style.display = "";
    }

    atualizarBotoesNavegacao();
  }

  function atualizarBotoesNavegacao() {
    var btnAnterior = document.getElementById("btnAnterior");
    var btnProximo = document.getElementById("btnProximo");

    btnAnterior.disabled = paginaAtual === 1;
    btnProximo.disabled = paginaAtual === Math.ceil(registros.length / registrosPorPagina);
  }

  document.getElementById("btnAnterior").addEventListener("click", function () {
    if (paginaAtual > 1) {
      paginaAtual--;
      exibirPagina(paginaAtual);
    }
  });

  document.getElementById("btnProximo").addEventListener("click", function () {
    if (paginaAtual < Math.ceil(registros.length / registrosPorPagina)) {
      paginaAtual++;
      exibirPagina(paginaAtual);
    }
  });
</script>
{% endblock %}
